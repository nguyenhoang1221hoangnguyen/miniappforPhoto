<script type="text/html" id="jobFormTemplate">
  <form id="jobForm" onsubmit="submitJobForm(event)">
    <input type="hidden" id="jobId" name="jobId">
    
    <div class="form-section-title">ğŸ‘¤ ThÃ´ng tin khÃ¡ch hÃ ng</div>
    
    <div class="form-group autocomplete-wrapper">
      <label>TÃªn khÃ¡ch hÃ ng *</label>
      <input type="text" id="customerName" name="customerName" required 
             autocomplete="off" placeholder="Nháº­p tÃªn Ä‘á»ƒ tÃ¬m kiáº¿m..."
             oninput="handleCustomerInput(this)"
             onfocus="handleCustomerInput(this)">
      <input type="hidden" id="customerId" name="customerId">
      <div id="customerAutocomplete" class="autocomplete-results"></div>
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label>Sá»‘ Ä‘iá»‡n thoáº¡i</label>
        <input type="tel" id="customerPhone" name="customerPhone" placeholder="0901234567">
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="customerEmail" name="customerEmail" placeholder="email@example.com">
      </div>
    </div>
    
    <div class="form-section-title">ğŸ“· ThÃ´ng tin Job</div>
    
    <div class="form-row">
      <div class="form-group">
        <label>NgÃ y chá»¥p *</label>
        <input type="datetime-local" id="shootDate" name="shootDate" required>
      </div>
      <div class="form-group">
        <label>Loáº¡i chá»¥p</label>
        <select id="jobType" name="jobType">
          <option value="">-- Chá»n --</option>
        </select>
      </div>
    </div>
    
    <div class="form-group autocomplete-wrapper">
      <label>Äá»‹a Ä‘iá»ƒm</label>
      <input type="text" id="location" name="location" autocomplete="off"
             placeholder="Nháº­p Ä‘á»‹a Ä‘iá»ƒm chá»¥p..."
             onkeyup="searchLocationAutocomplete(this.value)">
      <div id="locationAutocomplete" class="autocomplete-results"></div>
    </div>
    
    <div class="form-section-title">ğŸ’° Thanh toÃ¡n</div>
    
    <div class="form-row">
      <div class="form-group">
        <label>Tá»•ng tiá»n (VNÄ)</label>
        <input type="text" id="totalAmount" name="totalAmount" value="0"
               placeholder="0" inputmode="numeric"
               oninput="formatCurrencyInput(this)" onchange="calculateRemaining()">
      </div>
      <div class="form-group">
        <label>ÄÃ£ thanh toÃ¡n</label>
        <input type="text" id="paidAmount" name="paidAmount" value="0"
               placeholder="0" inputmode="numeric"
               oninput="formatCurrencyInput(this)" onchange="calculateRemaining()">
      </div>
    </div>
    
    <div class="form-group">
      <label>Tráº¡ng thÃ¡i Job</label>
      <select id="jobStatus" name="jobStatus">
        <option value="Chá» chá»¥p">Chá» chá»¥p</option>
        <option value="Äang lÃ m">Äang lÃ m</option>
        <option value="HoÃ n thÃ nh">HoÃ n thÃ nh</option>
        <option value="ÄÃ£ há»§y">ÄÃ£ há»§y</option>
      </select>
    </div>
    
    <div class="form-group">
      <label>Link Google Drive (hÃ¬nh final)</label>
      <input type="url" id="driveLink" name="driveLink" placeholder="https://drive.google.com/...">
    </div>
    
    <div class="form-section-title">ğŸ¤ Partner</div>
    
    <div class="form-group autocomplete-wrapper">
      <label>Partner (náº¿u cÃ³)</label>
      <input type="text" id="partnerName" name="partnerName" autocomplete="off"
             placeholder="Nháº­p tÃªn partner..."
             oninput="handlePartnerInput(this)"
             onfocus="handlePartnerInput(this)">
      <input type="hidden" id="partnerId" name="partnerId">
      <input type="hidden" id="partnerEmail" name="partnerEmail">
      <div id="partnerAutocomplete" class="autocomplete-results"></div>
    </div>
    
    <div class="form-group">
      <label>LÆ°Æ¡ng Partner (cho job nÃ y)</label>
      <input type="text" id="partnerFee" name="partnerFee" value="0" 
             placeholder="0" inputmode="numeric"
             oninput="formatCurrencyInput(this)">
    </div>
    
    <div class="form-group">
      <label>Ghi chÃº</label>
      <textarea id="notes" name="notes" placeholder="Ghi chÃº thÃªm vá» job..."></textarea>
    </div>
    
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" onclick="closeModal()">Há»§y</button>
      <button type="submit" class="btn btn-primary">ğŸ’¾ LÆ°u Job</button>
    </div>
  </form>
</script>

<script type="text/html" id="customerFormTemplate">
  <form id="customerForm" onsubmit="submitCustomerForm(event)">
    <input type="hidden" id="editCustomerId" name="customerId">
    
    <div class="form-group">
      <label>TÃªn khÃ¡ch hÃ ng *</label>
      <input type="text" id="editCustomerName" name="name" required placeholder="Nguyá»…n VÄƒn A">
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label>Sá»‘ Ä‘iá»‡n thoáº¡i</label>
        <input type="tel" id="editCustomerPhone" name="phone" placeholder="0901234567">
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="editCustomerEmail" name="email" placeholder="email@example.com">
      </div>
    </div>
    
    <div class="form-group">
      <label>Äá»‹a chá»‰</label>
      <input type="text" id="editCustomerAddress" name="address" placeholder="Sá»‘ nhÃ , Ä‘Æ°á»ng, quáº­n...">
    </div>
    
    <div class="form-group">
      <label>Ghi chÃº</label>
      <textarea id="editCustomerNotes" name="notes" placeholder="Ghi chÃº vá» khÃ¡ch hÃ ng..."></textarea>
    </div>
    
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" onclick="closeModal()">Há»§y</button>
      <button type="submit" class="btn btn-primary">ğŸ’¾ LÆ°u</button>
    </div>
  </form>
</script>

<script type="text/html" id="partnerFormTemplate">
  <form id="partnerForm" onsubmit="submitPartnerForm(event)">
    <input type="hidden" id="editPartnerId" name="partnerId">
    
    <div class="form-group">
      <label>TÃªn Partner *</label>
      <input type="text" id="editPartnerName" name="name" required placeholder="TÃªn partner">
    </div>
    
    <div class="form-row">
      <div class="form-group">
        <label>Sá»‘ Ä‘iá»‡n thoáº¡i</label>
        <input type="tel" id="editPartnerPhone" name="phone" placeholder="0901234567">
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="editPartnerEmail" name="email" placeholder="email@example.com">
      </div>
    </div>
    
    <div class="form-group">
      <label>ChuyÃªn mÃ´n</label>
      <select id="editPartnerSpecialty" name="specialty">
        <option value="">-- Chá»n --</option>
        <option value="Photographer">ğŸ“¸ Photographer</option>
        <option value="Editor">ğŸ–¥ï¸ Editor</option>
        <option value="Assistant">ğŸ™‹ Assistant</option>
        <option value="Makeup">ğŸ’„ Makeup</option>
        <option value="KhÃ¡c">ğŸ“Œ KhÃ¡c</option>
      </select>
    </div>
    
    <div class="form-group">
      <label>Ghi chÃº</label>
      <textarea id="editPartnerNotes" name="notes" placeholder="Ghi chÃº vá» partner..."></textarea>
    </div>
    
    <div class="form-actions">
      <button type="button" class="btn btn-secondary" onclick="closeModal()">Há»§y</button>
      <button type="submit" class="btn btn-primary">ğŸ’¾ LÆ°u</button>
    </div>
  </form>
</script>

<script type="text/html" id="jobDetailTemplate">
  <div class="detail-section">
    <h4>ğŸ‘¤ KhÃ¡ch hÃ ng</h4>
    <div class="detail-row">
      <span class="label">TÃªn</span>
      <span class="value">{customerName}</span>
    </div>
    <div class="detail-row">
      <span class="label">SÄT</span>
      <span class="value"><a href="tel:{customerPhone}">{customerPhone}</a></span>
    </div>
    <div class="detail-row">
      <span class="label">Email</span>
      <span class="value"><a href="mailto:{customerEmail}">{customerEmail}</a></span>
    </div>
  </div>
  
  <div class="detail-section">
    <h4>ğŸ“· ThÃ´ng tin Job</h4>
    <div class="detail-row">
      <span class="label">MÃ£ Job</span>
      <span class="value">{id}</span>
    </div>
    <div class="detail-row">
      <span class="label">NgÃ y chá»¥p</span>
      <span class="value">{shootDate}</span>
    </div>
    <div class="detail-row">
      <span class="label">Äá»‹a Ä‘iá»ƒm</span>
      <span class="value">{location}</span>
    </div>
    <div class="detail-row">
      <span class="label">Loáº¡i chá»¥p</span>
      <span class="value">{jobType}</span>
    </div>
    <div class="detail-row">
      <span class="label">Tráº¡ng thÃ¡i</span>
      <span class="value">{jobStatus}</span>
    </div>
    <div class="detail-row">
      <span class="label">Link Drive</span>
      <span class="value"><a href="{driveLink}" target="_blank">ğŸ“ Xem hÃ¬nh</a></span>
    </div>
  </div>
  
  <div class="detail-section">
    <h4>ğŸ’° Thanh toÃ¡n</h4>
    <div class="detail-row">
      <span class="label">Tá»•ng tiá»n</span>
      <span class="value">{totalAmount}</span>
    </div>
    <div class="detail-row">
      <span class="label">ÄÃ£ thanh toÃ¡n</span>
      <span class="value text-success">{paidAmount}</span>
    </div>
    <div class="detail-row">
      <span class="label">CÃ²n ná»£</span>
      <span class="value text-danger">{remainingAmount}</span>
    </div>
    <div class="detail-row">
      <span class="label">Tráº¡ng thÃ¡i</span>
      <span class="value">{paymentStatus}</span>
    </div>
  </div>
  
  <div class="detail-section">
    <h4>ğŸ¤ Partner</h4>
    <div class="detail-row">
      <span class="label">TÃªn</span>
      <span class="value">{partnerName}</span>
    </div>
    <div class="detail-row">
      <span class="label">LÆ°Æ¡ng</span>
      <span class="value">{partnerFee}</span>
    </div>
  </div>
  
  <div class="detail-section">
    <h4>ğŸ“ Ghi chÃº</h4>
    <p style="color: var(--text-secondary); font-size: 0.875rem;">{notes}</p>
  </div>
  
  <div class="form-actions">
    <button type="button" class="btn btn-secondary" onclick="showPaymentHistory('{id}')">ğŸ’° Thanh toÃ¡n</button>
    <button type="button" class="btn btn-danger" onclick="confirmDeleteJob('{id}')">ğŸ—‘ï¸ XÃ³a</button>
    <button type="button" class="btn btn-primary" onclick="editJob('{id}')">âœï¸ Sá»­a</button>
  </div>
</script>

<!-- Payment History Template -->
<script type="text/html" id="paymentHistoryTemplate">
  <div class="payment-history-container">
    <!-- Tab Navigation -->
    <div class="payment-tabs">
      <button class="payment-tab active" data-tab="customer" onclick="switchPaymentTab('customer')">
        ğŸ’° Thu tá»« khÃ¡ch
      </button>
      <button class="payment-tab" data-tab="partner" onclick="switchPaymentTab('partner')">
        ğŸ’¸ Tráº£ Partner
      </button>
    </div>

    <!-- Customer Payments Tab -->
    <div id="customerPaymentsTab" class="payment-tab-content active">
      <div class="payment-summary">
        <div class="summary-item">
          <div class="label">Tá»•ng tiá»n</div>
          <div class="value" id="customerTotal">0</div>
        </div>
        <div class="summary-item">
          <div class="label">ÄÃ£ thu</div>
          <div class="value success" id="customerPaid">0</div>
        </div>
        <div class="summary-item">
          <div class="label">CÃ²n ná»£</div>
          <div class="value danger" id="customerRemaining">0</div>
        </div>
      </div>

      <button class="btn btn-primary btn-block" onclick="showAddPaymentForm('customer')" style="margin-bottom: 16px;">
        â• Ghi nháº­n thanh toÃ¡n
      </button>

      <div id="customerPaymentsList" class="payments-list">
        <div class="empty-state">
          <div class="icon">ğŸ’°</div>
          <p>ChÆ°a cÃ³ thanh toÃ¡n nÃ o</p>
        </div>
      </div>
    </div>

    <!-- Partner Payments Tab -->
    <div id="partnerPaymentsTab" class="payment-tab-content">
      <div class="payment-summary">
        <div class="summary-item">
          <div class="label">Tá»•ng lÆ°Æ¡ng</div>
          <div class="value" id="partnerTotal">0</div>
        </div>
        <div class="summary-item">
          <div class="label">ÄÃ£ tráº£</div>
          <div class="value success" id="partnerPaid">0</div>
        </div>
        <div class="summary-item">
          <div class="label">CÃ²n láº¡i</div>
          <div class="value danger" id="partnerRemaining">0</div>
        </div>
      </div>

      <button class="btn btn-primary btn-block" onclick="showAddPaymentForm('partner')" style="margin-bottom: 16px;">
        â• Thanh toÃ¡n Partner
      </button>

      <div id="partnerPaymentsList" class="payments-list">
        <div class="empty-state">
          <div class="icon">ğŸ’¸</div>
          <p>ChÆ°a cÃ³ thanh toÃ¡n nÃ o</p>
        </div>
      </div>
    </div>
  </div>

  <style>
    .payment-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      border-bottom: 2px solid var(--border-color);
    }

    .payment-tab {
      flex: 1;
      padding: 12px;
      background: transparent;
      border: none;
      border-bottom: 3px solid transparent;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
    }

    .payment-tab.active {
      color: var(--primary);
      border-bottom-color: var(--primary);
    }

    .payment-tab-content {
      display: none;
    }

    .payment-tab-content.active {
      display: block;
    }

    .payment-summary {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-bottom: 20px;
      padding: 16px;
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
    }

    .summary-item {
      text-align: center;
    }

    .summary-item .label {
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-bottom: 4px;
    }

    .summary-item .value {
      font-size: 1.125rem;
      font-weight: 700;
      color: var(--text-primary);
    }

    .summary-item .value.success {
      color: var(--success);
    }

    .summary-item .value.danger {
      color: var(--danger);
    }

    .payments-list {
      max-height: 300px;
      overflow-y: auto;
    }

    .payment-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      border-bottom: 1px solid var(--border-color);
      background: var(--bg-primary);
    }

    .payment-item:hover {
      background: var(--bg-secondary);
    }

    .payment-item .info {
      flex: 1;
    }

    .payment-item .info .type {
      font-weight: 600;
      color: var(--text-primary);
    }

    .payment-item .info .date {
      font-size: 0.75rem;
      color: var(--text-secondary);
    }

    .payment-item .info .method {
      font-size: 0.75rem;
      color: var(--text-secondary);
    }

    .payment-item .amount {
      font-weight: 700;
      color: var(--success);
      margin: 0 12px;
    }

    .payment-item .delete-btn {
      background: transparent;
      border: none;
      color: var(--danger);
      cursor: pointer;
      font-size: 1.25rem;
      padding: 4px 8px;
    }
  </style>
</script>

<!-- Add Payment Form Template -->
<script type="text/html" id="addPaymentFormTemplate">
  <form id="paymentForm" onsubmit="submitPaymentForm(event)">
    <input type="hidden" id="paymentJobId" name="jobId">
    <input type="hidden" id="paymentFor" name="paymentFor">

    <div class="form-group">
      <label>Sá»‘ tiá»n (VNÄ) *</label>
      <input type="text" id="paymentAmount" name="amount" required 
             placeholder="0" inputmode="numeric"
             oninput="formatCurrencyInput(this)">
    </div>

    <div class="form-group">
      <label>Loáº¡i thanh toÃ¡n</label>
      <select id="paymentType" name="paymentType">
        <option value="Cá»c">Cá»c</option>
        <option value="Äá»£t 1">Äá»£t 1</option>
        <option value="Äá»£t 2">Äá»£t 2</option>
        <option value="Äá»£t 3">Äá»£t 3</option>
        <option value="HoÃ n táº¥t">HoÃ n táº¥t</option>
        <option value="KhÃ¡c">KhÃ¡c</option>
      </select>
    </div>

    <div class="form-group">
      <label>PhÆ°Æ¡ng thá»©c</label>
      <select id="paymentMethod" name="paymentMethod">
        <option value="Chuyá»ƒn khoáº£n">Chuyá»ƒn khoáº£n</option>
        <option value="Tiá»n máº·t">Tiá»n máº·t</option>
        <option value="VÃ­ Ä‘iá»‡n tá»­">VÃ­ Ä‘iá»‡n tá»­</option>
        <option value="KhÃ¡c">KhÃ¡c</option>
      </select>
    </div>

    <div class="form-group">
      <label>NgÃ y thanh toÃ¡n</label>
      <input type="date" id="paymentDate" name="paymentDate">
    </div>

    <div class="form-group">
      <label>Ghi chÃº</label>
      <textarea id="paymentNotes" name="notes" rows="2" placeholder="Ghi chÃº thÃªm..."></textarea>
    </div>

    <div class="form-actions">
      <button type="button" class="btn btn-secondary" onclick="closePaymentForm()">Há»§y</button>
      <button type="submit" class="btn btn-primary">ğŸ’¾ LÆ°u</button>
    </div>
  </form>
</script>
