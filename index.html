<!DOCTYPE html>
<html lang="vi">
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="theme-color" content="#6366f1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“·</text></svg>">
  <title>Photo Job Manager</title>
  <?!= include('styles'); ?>
</head>
<body>
  <!-- Setup Screen -->
  <div id="setupScreen" class="setup-screen">
    <div class="setup-container">
      <div class="setup-logo">ğŸ“·</div>
      <h1>Photo Job Manager</h1>
      <p class="setup-subtitle">Káº¿t ná»‘i vá»›i Google Sheet cá»§a báº¡n</p>
      
      <div class="setup-form">
        <div class="form-group">
          <label>Link Google Sheet</label>
          <input type="text" id="spreadsheetUrlInput" placeholder="DÃ¡n link Google Sheet cá»§a báº¡n vÃ o Ä‘Ã¢y">
          <p class="help-text">
            VÃ­ dá»¥: https://docs.google.com/spreadsheets/d/.../edit
          </p>
        </div>
        
        <button class="btn btn-primary btn-block" onclick="connectSpreadsheet()">
          ğŸ”— Káº¿t ná»‘i
        </button>
        
        <div id="setupError" class="setup-error"></div>
        <div id="setupLoading" class="setup-loading" style="display:none;">
          <div class="loading"></div>
          <p>Äang káº¿t ná»‘i...</p>
        </div>
      </div>
      
      <div class="setup-help">
        <h4>ğŸ“– HÆ°á»›ng dáº«n</h4>
        <ol>
          <li>Táº¡o má»™t Google Sheet má»›i</li>
          <li>Copy link tá»« thanh Ä‘á»‹a chá»‰ trÃ¬nh duyá»‡t</li>
          <li>DÃ¡n link vÃ o Ã´ trÃªn vÃ  nháº¥n Káº¿t ná»‘i</li>
          <li>Cáº¥p quyá»n truy cáº­p khi Ä‘Æ°á»£c yÃªu cáº§u (chá»‰ láº§n Ä‘áº§u)</li>
        </ol>
        <p style="margin-top: 12px; font-size: 12px; color: #64748b;">
          ğŸ’¡ Dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»±c tiáº¿p trÃªn Sheet cá»§a báº¡n. Lá»‹ch chá»¥p sáº½ Ä‘Æ°á»£c táº¡o trÃªn Google Calendar cá»§a báº¡n.
        </p>
      </div>
    </div>
  </div>

  <!-- Main App -->
  <div id="mainApp" class="app-container" style="display:none;">
    <!-- Header -->
    <header class="app-header">
      <h1>ğŸ“· Photo Jobs</h1>
      <div class="header-actions">
        <button class="header-btn" onclick="loadDashboard()" title="Refresh">ğŸ”„</button>
        <button class="header-btn" onclick="showShareLink()" title="Chia sáº»">ğŸ”—</button>
        <button class="header-btn" onclick="showSettings()" title="CÃ i Ä‘áº·t">âš™ï¸</button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Dashboard Tab -->
      <div id="dashboard" class="tab-content active">
        <div class="dashboard-stats" id="dashboardStats">
          <div class="loading">Äang táº£i...</div>
        </div>
        
        <div class="section">
          <h3>ğŸ“… Lá»‹ch chá»¥p sáº¯p tá»›i</h3>
          <div id="upcomingJobs" class="upcoming-jobs">
            <div class="loading">Äang táº£i...</div>
          </div>
        </div>
      </div>

      <!-- Jobs Tab -->
      <div id="jobs" class="tab-content">
        <div class="search-box">
          <input type="text" id="jobSearchInput" placeholder="TÃ¬m theo tÃªn, Ä‘á»‹a Ä‘iá»ƒm..." onkeyup="debounceSearch()">
        </div>
        
        <div class="filters">
          <select id="filterJobStatus" onchange="filterJobs()">
            <option value="">Táº¥t cáº£ tráº¡ng thÃ¡i</option>
            <option value="Chá» chá»¥p">Chá» chá»¥p</option>
            <option value="Äang lÃ m">Äang lÃ m</option>
            <option value="HoÃ n thÃ nh">HoÃ n thÃ nh</option>
          </select>
          <select id="filterPaymentStatus" onchange="filterJobs()">
            <option value="">Táº¥t cáº£ TT</option>
            <option value="ChÆ°a thanh toÃ¡n">ChÆ°a TT</option>
            <option value="ÄÃ£ TT má»™t pháº§n">TT má»™t pháº§n</option>
            <option value="ÄÃ£ thanh toÃ¡n háº¿t">ÄÃ£ TT háº¿t</option>
          </select>
        </div>
        
        <div id="jobsList" class="items-list">
          <div class="loading">Äang táº£i...</div>
        </div>
      </div>

      <!-- Customers Tab -->
      <div id="customers" class="tab-content">
        <div class="search-box">
          <input type="text" id="customerSearchInput" placeholder="TÃ¬m khÃ¡ch hÃ ng..." onkeyup="debounceSearchCustomers()">
        </div>
        
        <div id="customersList" class="items-list">
          <div class="loading">Äang táº£i...</div>
        </div>
      </div>

      <!-- Partners Tab -->
      <div id="partners" class="tab-content">
        <div class="search-box">
          <input type="text" id="partnerSearchInput" placeholder="TÃ¬m partner..." onkeyup="debounceSearchPartners()">
        </div>
        
        <div id="partnersList" class="items-list">
          <div class="loading">Äang táº£i...</div>
        </div>
      </div>

      <!-- Reports Tab -->
      <div id="reports" class="tab-content">
        <?!= include('reports'); ?>
      </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="nav-tabs">
      <button class="tab-btn active" data-tab="dashboard">
        <span class="icon">ğŸ“Š</span>
        <span class="label">Tá»•ng quan</span>
      </button>
      <button class="tab-btn" data-tab="jobs">
        <span class="icon">ğŸ“‹</span>
        <span class="label">Jobs</span>
      </button>
      <button class="tab-btn" data-tab="customers">
        <span class="icon">ğŸ‘¥</span>
        <span class="label">KhÃ¡ch</span>
      </button>
      <button class="tab-btn" data-tab="partners">
        <span class="icon">ğŸ¤</span>
        <span class="label">Partner</span>
      </button>
      <button class="tab-btn" data-tab="reports">
        <span class="icon">ğŸ“ˆ</span>
        <span class="label">BÃ¡o cÃ¡o</span>
      </button>
    </nav>

    <!-- Floating Action Button -->
    <button class="fab" id="fabBtn" onclick="handleFabClick()">â•</button>
  </div>

  <!-- Modal Container -->
  <div id="modalOverlay" class="modal-overlay" onclick="closeModal()">
    <div class="modal" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h2 id="modalTitle">Modal Title</h2>
        <button class="close-btn" onclick="closeModal()">âœ•</button>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- Dynamic content -->
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="toast"></div>

  <!-- Setup Screen Styles -->
  <style>
    .setup-screen {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
    }
    
    .setup-container {
      background: white;
      border-radius: 20px;
      padding: 40px;
      max-width: 400px;
      width: 100%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .setup-logo {
      font-size: 64px;
      margin-bottom: 16px;
    }
    
    .setup-container h1 {
      font-size: 24px;
      margin-bottom: 8px;
      color: #1e293b;
    }
    
    .setup-subtitle {
      color: #64748b;
      margin-bottom: 32px;
    }
    
    .setup-form {
      text-align: left;
    }
    
    .setup-form .form-group {
      margin-bottom: 20px;
    }
    
    .setup-form input {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      font-size: 14px;
    }
    
    .setup-form input:focus {
      outline: none;
      border-color: #6366f1;
    }
    
    .help-text {
      font-size: 12px;
      color: #64748b;
      margin-top: 8px;
    }
    
    .help-text strong {
      color: #6366f1;
    }
    
    .btn-block {
      display: block;
      width: 100%;
    }
    
    .setup-error {
      color: #ef4444;
      font-size: 14px;
      margin-top: 16px;
      text-align: center;
    }
    
    .setup-loading {
      text-align: center;
      padding: 20px;
    }
    
    .setup-loading .loading {
      padding: 0;
    }
    
    .setup-loading .loading::before {
      margin-bottom: 8px;
    }
    
    .setup-help {
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid #e2e8f0;
      text-align: left;
    }
    
    .setup-help h4 {
      font-size: 14px;
      margin-bottom: 12px;
      color: #1e293b;
    }
    
    .setup-help ol {
      padding-left: 20px;
      font-size: 13px;
      color: #64748b;
    }
    
    .setup-help li {
      margin-bottom: 8px;
    }
    
    .setup-help strong {
      color: #1e293b;
      word-break: break-all;
    }
  </style>

  <?!= include('components'); ?>
  <?!= include('app.js'); ?>
  <?!= include('autocomplete.js'); ?>
</body>
</html>
